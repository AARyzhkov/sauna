import numpy as np
import importlib.metadata
from .sensitivity import *
from .covariance import *
from .bridge import *
from .auxiliary import *
from .analysis import *
from .plot import *

__version__ = importlib.metadata.version("sauna")

"""Dictionary of commonly used energy group structures:

- "ABBN-X" (where X is 28 which is designed for fast reactor analysis, and 299 is designed
   general-purpose and shielding analyses) from ABBN libraries ([ABBN-28/299]_)
- "ECCO-33_" is designed for  for fast reactor analysis ([SAR1990]_)
- "SCALE-X" (where X is 44 which is designed for thermal reactor analysis (collapsed version 
   of 238-group library), 56 is designed for thermal reactor analysis, and 252 is designed
   for criticality and general-purpose thermal reactor physics analyses) from the SCALE code
   system ([ZAL1999]_ and [WWLR2024]_)
- "WPEC-SG64" is designed for sensitivity and uncertainty analysis by the SG46 group under
   NEA ([CAB2023]_)
.. "UFLIB-70" is designed for for fast reactor analysis ([SUG2024]_)
   
.. _ABBN-28/299:  https://inis.iaea.org/collection/NCLCollectionStore/_Public/28/075/28075558.pdf
.. _ECCO-33:      http://serpent.vtt.fi/mediawiki/index.php/ECCO_33-group_structure
.. _WPEC-SG46:    https://www.epj-conferences.org/10.1051/epjconf/202328414012
.. _SCALE-44:     https://www-nds.iaea.org/publications/indc/indc-czr-0001.pdf
.. _SCALE-56/252: https://info.ornl.gov/sites/publications/Files/Pub213297.pdf
.. _UFLIB-70:     https://jopss.jaea.go.jp/pdfdata/JAEA-Data-Code-2011-017.pdf

.. [MANT1996] Manturov, G.N., Nikolaev, M.N., Tsibulya, A.M., 1996. BNAB-93 Group
   Data Library. Part 1: Nuclear Data for the Calculation of Neutron and Photon
   Radiation Fields. Nuclear Constants. ABBN-28/299_.
.. [SAR1990] Sartori, E., OECD/NEA Data Bank: Standard Energy Group Structures
   of Cross Section Libraries for Reactor Shielding, Reactor Cell and Fusion
   Neutronics Applications: VITAMIN-J, ECCO-33, ECCO-2000 and XMAS JEF/DOC-315
   Revision 3 - DRAFT (December 11, 1990).
.. [CAB2023] Cabellos, O., Hursin, M., Palmiotti, P., 2023. WPEC/SG46 Exercise on Target s
   Accuracy Requirement, in: Mattoon, C.M., Vogt, R., Escher, J., Thompson, I. (Eds.), 
   EPJ Web of Conferences. p. 14012. WPEC-SG46_.
.. [ZAL1999] K. Záleský and L. Marková (1999), Assessment of Nuclear Data Needs
   for Broad-Group SCALE Library Related to VVER Spent Fuel Applications, IAEA. SCALE-44_.
.. [WWLR2024] Wieselquist, W., Lefebvre, R., 2024. SCALE 6.3.2 User Manual
   (No. ORNL/TM-2024/3386; ORNL/TM-SCALE-6.3.2). Oak Ridge National Laboratory, Oak Ridge,
   TN, US. SCALE-56/252_.
.. [SUG2024] Sugino, K., Jin, T., Hazama, T., Numata, K., 2012. Preparation of Fast Reactor
   Group Constant Sets UFLIB.J40 and JFS-3-J4.0 Based on the JENDL-4.0 Data (No. 2017-017).
   Japan Atomic Energy Agency, Japan. UFLIB-70_.

"""

GROUP_STRUCTURES = {}

GROUP_STRUCTURES['ABBN-28'] = np.array([1.000000E-5, 2.154434E-1, 4.641589E-1, 1.000000E+0, 2.154434E+0,
                                        4.641589E+0, 1.000000E+1, 2.154434E+1, 4.641589E+1, 1.000000E+2,
                                        2.154434E+2, 4.641589E+2, 1.000000E+3, 2.154434E+3, 4.641589E+3,
                                        1.000000E+4, 2.154434E+4, 4.641589E+4, 1.000000E+5, 2.000000E+5,
                                        4.000000E+5, 8.000000E+5, 1.400000E+6, 2.500000E+6, 4.000000E+6,
                                        6.500000E+6, 1.050000E+7, 1.398180E+7, 2.000000E+7])

GROUP_STRUCTURES['ABBN-299'] = np.array([1.00000E-05, 1.00000E-04, 1.00000E-03, 2.15443E-03, 3.16227E-03,
                                         4.54158E-03, 6.81292E-03, 1.00000E-02, 1.21153E-02, 1.46780E-02,
                                         1.77828E-02, 2.15443E-02, 2.61016E-02, 3.16228E-02, 3.83119E-02,
                                         4.64159E-02, 5.62341E-02, 6.81292E-02, 8.25404E-02, 1.00000E-01,
                                         1.13646E-01, 1.29155E-01, 1.46780E-01, 1.66810E-01, 1.89574E-01,
                                         2.15443E-01, 2.29674E-01, 2.44844E-01, 2.61016E-01, 2.78256E-01,
                                         2.96635E-01, 3.16228E-01, 3.37115E-01, 3.59381E-01, 3.83119E-01,
                                         4.08424E-01, 4.35400E-01, 4.64159E-01, 4.94817E-01, 5.27500E-01,
                                         5.62341E-01, 5.99484E-01, 6.39080E-01, 6.81292E-01, 7.26292E-01,
                                         7.74264E-01, 8.25404E-01, 8.79923E-01, 9.38042E-01, 1.00000E+00,
                                         1.06605E+00, 1.13646E+00, 1.21153E+00, 1.29155E+00, 1.37686E+00,
                                         1.46780E+00, 1.56475E+00, 1.66810E+00, 1.77828E+00, 1.89574E+00,
                                         2.02095E+00, 2.15443E+00, 2.29674E+00, 2.44844E+00, 2.61016E+00,
                                         2.78256E+00, 2.96635E+00, 3.16228E+00, 3.37115E+00, 3.59381E+00,
                                         3.83119E+00, 4.08424E+00, 4.35400E+00, 4.64159E+00, 4.94817E+00,
                                         5.27500E+00, 5.62341E+00, 5.99484E+00, 6.39080E+00, 6.81292E+00,
                                         7.26292E+00, 7.74264E+00, 8.25404E+00, 8.79923E+00, 9.38042E+00,
                                         1.00000E+01, 1.06605E+01, 1.13646E+01, 1.21153E+01, 1.29155E+01,
                                         1.37686E+01, 1.46780E+01, 1.56475E+01, 1.66810E+01, 1.77828E+01,
                                         1.89574E+01, 2.02095E+01, 2.15443E+01, 2.29674E+01, 2.44844E+01,
                                         2.61016E+01, 2.78256E+01, 2.96635E+01, 3.16228E+01, 3.37115E+01,
                                         3.59381E+01, 3.83119E+01, 4.08424E+01, 4.35400E+01, 4.64159E+01,
                                         4.94817E+01, 5.27500E+01, 5.62341E+01, 5.99484E+01, 6.39080E+01,
                                         6.81292E+01, 7.26292E+01, 7.74264E+01, 8.25404E+01, 8.79923E+01,
                                         9.38042E+01, 1.00000E+02, 1.06605E+02, 1.13646E+02, 1.21153E+02,
                                         1.29155E+02, 1.37686E+02, 1.46780E+02, 1.56475E+02, 1.66810E+02,
                                         1.77828E+02, 1.89574E+02, 2.02095E+02, 2.15443E+02, 2.29674E+02,
                                         2.44844E+02, 2.61016E+02, 2.78256E+02, 2.96635E+02, 3.16228E+02,
                                         3.37115E+02, 3.59381E+02, 3.83119E+02, 4.08424E+02, 4.35400E+02,
                                         4.64159E+02, 4.94817E+02, 5.27500E+02, 5.62341E+02, 5.99484E+02,
                                         6.39080E+02, 6.81292E+02, 7.26292E+02, 7.74264E+02, 8.25404E+02,
                                         8.79923E+02, 9.38042E+02, 1.00000E+03, 1.06605E+03, 1.13646E+03,
                                         1.21153E+03, 1.29155E+03, 1.37686E+03, 1.46780E+03, 1.56475E+03,
                                         1.66810E+03, 1.77828E+03, 1.89573E+03, 2.02095E+03, 2.15443E+03,
                                         2.29673E+03, 2.44843E+03, 2.61015E+03, 2.78256E+03, 2.96635E+03,
                                         3.16227E+03, 3.37115E+03, 3.59381E+03, 3.83119E+03, 4.08424E+03,
                                         4.35400E+03, 4.64159E+03, 4.94817E+03, 5.27500E+03, 5.62341E+03,
                                         5.99484E+03, 6.39081E+03, 6.81292E+03, 7.26292E+03, 7.74264E+03,
                                         8.25404E+03, 8.79923E+03, 9.38042E+03, 1.00000E+04, 1.06605E+04,
                                         1.13646E+04, 1.21153E+04, 1.29155E+04, 1.37686E+04, 1.46780E+04,
                                         1.56475E+04, 1.66810E+04, 1.77828E+04, 1.89573E+04, 2.02095E+04,
                                         2.15443E+04, 2.29673E+04, 2.44843E+04, 2.61015E+04, 2.78256E+04,
                                         2.96635E+04, 3.16227E+04, 3.37115E+04, 3.59381E+04, 3.83119E+04,
                                         4.08424E+04, 4.35400E+04, 4.64159E+04, 4.94817E+04, 5.27500E+04,
                                         5.62341E+04, 5.99484E+04, 6.39081E+04, 6.81292E+04, 7.26292E+04,
                                         7.74264E+04, 8.25404E+04, 8.79923E+04, 9.38042E+04, 1.00000E+05,
                                         1.08006E+05, 1.16653E+05, 1.25992E+05, 1.36079E+05, 1.46973E+05,
                                         1.58740E+05, 1.71449E+05, 1.85175E+05, 2.00000E+05, 2.16012E+05,
                                         2.33306E+05, 2.51984E+05, 2.72158E+05, 2.93947E+05, 3.17480E+05,
                                         3.42898E+05, 3.70350E+05, 4.00000E+05, 4.32024E+05, 4.66612E+05,
                                         5.03968E+05, 5.44316E+05, 5.87894E+05, 6.34960E+05, 6.85795E+05,
                                         7.40700E+05, 8.00000E+05, 8.57965E+05, 9.20131E+05, 9.86800E+05,
                                         1.05830E+06, 1.13498E+06, 1.21722E+06, 1.30541E+06, 1.40000E+06,
                                         1.50524E+06, 1.61838E+06, 1.74003E+06, 1.87083E+06, 2.01146E+06,
                                         2.16265E+06, 2.32522E+06, 2.50000E+06, 2.70371E+06, 2.92402E+06,
                                         3.16228E+06, 3.41995E+06, 3.69862E+06, 4.00000E+06, 4.33713E+06,
                                         4.70267E+06, 5.09902E+06, 5.52877E+06, 5.99475E+06, 6.50000E+06,
                                         7.04086E+06, 7.62674E+06, 8.26136E+06, 8.94878E+06, 9.69341E+06,
                                         1.05000E+07, 1.12793E+07, 1.21165E+07, 1.30158E+07, 1.39818E+07,
                                         1.50195E+07, 1.61343E+07, 1.73318E+07, 1.86182E+07, 2.00000E+07])

GROUP_STRUCTURES['ICSBEP'] = np.array([1.00E-05, 1.00E-02, 2.15E-02, 4.64E-02, 1.00E-01,
                                       2.15E-01, 4.64E-01, 1.00E+00, 2.15E+00, 4.64E+00,
                                       1.00E+01, 2.15E+01, 4.64E+01, 1.00E+02, 2.15E+02, 
                                       4.64E+02, 1.00E+03, 2.15E+03, 4.64E+03, 1.00E+04,
                                       2.15E+04, 4.64E+04, 1.00E+05, 2.00E+05, 4.00E+05,
                                       8.00E+05, 1.40E+06, 2.50E+06, 4.00E+06, 6.50E+06,
                                       2.00E+07])

GROUP_STRUCTURES['ECCO-33'] = np.array([1.00E-05, 1.00E-01, 5.40E-01, 4.00E+00, 8.32E+00,
                                        1.37E+01, 2.26E+01, 4.02E+01, 6.79E+01, 9.17E+01,
                                        1.49E+02, 3.04E+02, 4.54E+02, 7.49E+02, 1.23E+03,
                                        2.03E+03, 3.35E+03, 5.53E+03, 9.12E+03, 1.50E+04,
                                        2.48E+04, 4.09E+04, 6.74E+04, 1.11E+05, 1.83E+05,
                                        3.02E+05, 4.98E+05, 8.21E+05, 1.35E+06, 2.23E+06,
                                        3.68E+06, 6.07E+06, 1.00E+07, 1.96E+07])

GROUP_STRUCTURES['WPEC-SG46'] = np.array([1.00000E-05, 5.40000E-01, 2.26033E+01, 2.03468E+03, 6.73795E+04,
                                          4.97871E+05, 2.23130E+06, 1.96403E+07])

GROUP_STRUCTURES['SCALE-44'] = np.array([1.0000E-05, 3.0000E-03, 7.5000E-03, 1.0000E-02, 2.5300E-02,
                                         3.0000E-02, 4.0000E-02, 5.0000E-02, 7.0000E-02, 1.0000E-01,
                                         1.5000E-01, 2.0000E-01, 2.2500E-01, 2.5000E-01, 2.7500E-01,
                                         3.2500E-01, 3.5000E-01, 3.7500E-01, 4.0000E-01, 6.2500E-01,
                                         1.0000E+00, 1.7700E+00, 3.0000E+00, 4.7500E+00, 6.0000E+00,
                                         8.1000E+00, 1.0000E+01, 3.0000E+01, 1.0000E+02, 5.5000E+02,
                                         3.0000E+03, 1.7000E+04, 2.5000E+04, 1.0000E+05, 4.0000E+05,
                                         9.0000E+05, 1.4000E+06, 1.8500E+06, 2.3540E+06, 2.4790E+06,
                                         3.0000E+06, 4.8000E+06, 6.4340E+06, 8.1873E+06, 2.0000E+07])

GROUP_STRUCTURES['SCALE-56'] = np.array([1.000E-05, 4.000E-03, 1.000E-02, 2.530E-02, 4.000E-02,
                                         5.000E-02, 6.000E-02, 8.000E-02, 1.000E-01, 1.500E-01,
                                         2.000E-01, 2.500E-01, 3.250E-01, 3.500E-01, 3.750E-01,
                                         4.500E-01, 6.250E-01, 1.010E+00, 1.080E+00, 1.130E+00,
                                         5.000E+00, 6.250E+00, 6.500E+00, 6.875E+00, 7.000E+00,
                                         2.050E+01, 2.120E+01, 2.175E+01, 3.600E+01, 3.713E+01,
                                         6.500E+01, 6.750E+01, 1.012E+02, 1.050E+02, 1.160E+02,
                                         1.175E+02, 1.877E+02, 1.915E+02, 2.250E+03, 3.740E+03,
                                         1.700E+04, 2.000E+04, 5.000E+04, 2.000E+05, 2.700E+05,
                                         3.300E+05, 4.700E+05, 6.000E+05, 7.500E+05, 8.611E+05,
                                         1.200E+06, 1.500E+06, 1.850E+06, 3.000E+06, 4.304E+06,
                                         6.434E+06, 2.000E+07])

GROUP_STRUCTURES['SCALE-252'] = np.array([1.00000E-05, 1.00000E-04, 5.00000E-04, 7.50000E-04, 1.00000E-03,
                                          1.20000E-03, 1.50000E-03, 2.00000E-03, 2.50000E-03, 3.00000E-03,
                                          4.00000E-03, 5.00000E-03, 7.50000E-03, 1.00000E-02, 2.53000E-02,
                                          3.00000E-02, 4.00000E-02, 5.00000E-02, 6.00000E-02, 7.00000E-02,
                                          8.00000E-02, 9.00000E-02, 1.00000E-01, 1.25000E-01, 1.50000E-01,
                                          1.75000E-01, 2.00000E-01, 2.25000E-01, 2.50000E-01, 2.75000E-01,
                                          3.00000E-01, 3.25000E-01, 3.50000E-01, 3.75000E-01, 4.00000E-01,
                                          4.50000E-01, 5.00000E-01, 5.50000E-01, 6.00000E-01, 6.25000E-01,
                                          6.50000E-01, 7.00000E-01, 7.50000E-01, 8.00000E-01, 8.50000E-01,
                                          9.00000E-01, 9.25000E-01, 9.50000E-01, 9.75000E-01, 1.00000E+00,
                                          1.01000E+00, 1.02000E+00, 1.03000E+00, 1.04000E+00, 1.05000E+00,
                                          1.06000E+00, 1.07000E+00, 1.08000E+00, 1.09000E+00, 1.10000E+00,
                                          1.11000E+00, 1.12000E+00, 1.13000E+00, 1.14000E+00, 1.15000E+00,
                                          1.17500E+00, 1.20000E+00, 1.22500E+00, 1.25000E+00, 1.30000E+00,
                                          1.35000E+00, 1.40000E+00, 1.45000E+00, 1.50000E+00, 1.59000E+00,
                                          1.68000E+00, 1.77000E+00, 1.86000E+00, 1.94000E+00, 2.00000E+00,
                                          2.12000E+00, 2.21000E+00, 2.30000E+00, 2.38000E+00, 2.47000E+00,
                                          2.57000E+00, 2.67000E+00, 2.77000E+00, 2.87000E+00, 2.97000E+00,
                                          3.00000E+00, 3.10000E+00, 3.20000E+00, 3.50000E+00, 3.73000E+00,
                                          4.10000E+00, 4.70000E+00, 5.00000E+00, 5.40000E+00, 6.00000E+00,
                                          6.25000E+00, 6.50000E+00, 6.75000E+00, 6.87500E+00, 7.00000E+00,
                                          7.15000E+00, 8.10000E+00, 9.10000E+00, 1.00000E+01, 1.15000E+01,
                                          1.19000E+01, 1.29000E+01, 1.44000E+01, 1.60000E+01, 1.70000E+01,
                                          1.85000E+01, 1.94000E+01, 2.00000E+01, 2.05000E+01, 2.12000E+01,
                                          2.17500E+01, 2.25000E+01, 2.50000E+01, 2.75000E+01, 3.00000E+01,
                                          3.12500E+01, 3.17500E+01, 3.32500E+01, 3.37500E+01, 3.50000E+01,
                                          3.55000E+01, 3.60000E+01, 3.70000E+01, 3.71300E+01, 3.72700E+01,
                                          3.76300E+01, 3.80000E+01, 3.91000E+01, 3.96000E+01, 4.10000E+01,
                                          4.24000E+01, 4.40000E+01, 4.52000E+01, 4.83000E+01, 5.06000E+01,
                                          5.34000E+01, 5.80000E+01, 6.10000E+01, 6.30000E+01, 6.50000E+01,
                                          6.75000E+01, 7.20000E+01, 7.60000E+01, 8.00000E+01, 8.17000E+01,
                                          9.00000E+01, 9.70000E+01, 1.01200E+02, 1.05000E+02, 1.08000E+02,
                                          1.13000E+02, 1.16000E+02, 1.17500E+02, 1.19000E+02, 1.22000E+02,
                                          1.43000E+02, 1.70000E+02, 1.80000E+02, 1.87700E+02, 1.88500E+02,
                                          1.91500E+02, 1.93000E+02, 2.02000E+02, 2.07400E+02, 2.09500E+02,
                                          2.20000E+02, 2.40000E+02, 2.85000E+02, 3.05000E+02, 5.50000E+02,
                                          6.70000E+02, 6.83000E+02, 9.50000E+02, 1.15000E+03, 1.50000E+03,
                                          1.55000E+03, 1.80000E+03, 2.20000E+03, 2.25000E+03, 2.50000E+03,
                                          3.00000E+03, 3.74000E+03, 3.90000E+03, 5.70000E+03, 8.03000E+03,
                                          9.50000E+03, 1.30000E+04, 1.70000E+04, 2.00000E+04, 3.00000E+04,
                                          4.50000E+04, 5.00000E+04, 5.20000E+04, 6.00000E+04, 7.30000E+04,
                                          7.50000E+04, 8.20000E+04, 8.50000E+04, 1.00000E+05, 1.28300E+05,
                                          1.49000E+05, 2.00000E+05, 2.70000E+05, 3.30000E+05, 4.00000E+05,
                                          4.20000E+05, 4.40000E+05, 4.70000E+05, 4.92000E+05, 5.50000E+05,
                                          5.73000E+05, 6.00000E+05, 6.70000E+05, 6.79000E+05, 7.50000E+05,
                                          8.20000E+05, 8.61100E+05, 8.75000E+05, 9.00000E+05, 9.20000E+05,
                                          1.01000E+06, 1.10000E+06, 1.20000E+06, 1.25000E+06, 1.31700E+06,
                                          1.35600E+06, 1.40000E+06, 1.50000E+06, 1.85000E+06, 2.35400E+06,
                                          2.47900E+06, 3.00000E+06, 4.30400E+06, 4.80000E+06, 6.43400E+06,
                                          8.18700E+06, 1.00000E+07, 1.28400E+07, 1.38400E+07, 1.45500E+07,
                                          1.56800E+07, 1.73300E+07, 2.00000E+07])

GROUP_STRUCTURES['UFLIB-70'] = np.array([1.00000E-05, 3.22419E-01, 4.13994E-01, 5.31579E-01, 6.82560E-01,
                                         8.76425E-01, 1.12535E+00, 1.44498E+00, 1.85539E+00, 2.38237E+00,
                                         3.05902E+00, 3.92786E+00, 5.04348E+00, 6.47595E+00, 8.31529E+00,
                                         1.06770E+01, 1.37096E+01, 1.76035E+01, 2.26033E+01, 2.90232E+01,
                                         3.72665E+01, 4.78512E+01, 6.14421E+01, 7.88933E+01, 1.01301E+02,
                                         1.30073E+02, 1.67017E+02, 2.14454E+02, 2.75365E+02, 3.53575E+02,
                                         4.53999E+02, 5.82947E+02, 7.48518E+02, 9.61117E+02, 1.23410E+03,
                                         1.58461E+03, 2.03468E+03, 2.61259E+03, 3.35463E+03, 4.30743E+03,
                                         5.53084E+03, 7.10174E+03, 9.11882E+03, 1.17088E+04, 1.50344E+04,
                                         1.93045E+04, 2.47875E+04, 3.18278E+04, 4.08677E+04, 5.24752E+04,
                                         6.73795E+04, 8.65170E+04, 1.11090E+05, 1.42642E+05, 1.83156E+05,
                                         2.35178E+05, 3.01974E+05, 3.87742E+05, 4.97871E+05, 6.39279E+05,
                                         8.20850E+05, 1.05399E+06, 1.35335E+06, 1.73774E+06, 2.23130E+06,
                                         2.86505E+06, 3.67879E+06, 4.72367E+06, 6.06531E+06, 7.78801E+06,
                                         2.00000E+07])

